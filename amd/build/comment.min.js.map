{"version":3,"file":"comment.min.js","sources":["../src/comment.js"],"sourcesContent":["/*\n * Change comments\n *\n * @package    block_deft\n * @module     block_deft/comment\n * @copyright  2022 Daniel Thies <dethies@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport ModalForm from \"core_form/modalform\";\nimport {get_string as getString} from \"core/str\";\n\nexport default {\n\n    /**\n     * Listen for comment actions\n     *\n     * @param {int} contextid Context id of block\n     * @param {string} selector Content location to replace\n     * @param {object} refresh Interface to update content\n     */\n    init: function(contextid, selector, refresh) {\n        document.querySelector(selector).addEventListener('click', (e) => {\n            const button = e.target.closest('[data-type=\"comments\"] [data-action]');\n            if (button) {\n                let modalForm;\n                e.preventDefault();\n                e.stopPropagation();\n                switch (button.getAttribute('data-action')) {\n                    case 'addcomment':\n                        modalForm = new ModalForm({\n                            formClass: \"block_deft\\\\form\\\\add_comment\",\n                            args: {\n                                contextid: contextid,\n                                id: button.closest('[data-task]').getAttribute('data-task')\n                            },\n                            modalConfig: {\n                                title: getString('addcomment')\n                            }\n                        });\n                        break;\n                    case 'delete':\n                        modalForm = new ModalForm({\n                            formClass: \"block_deft\\\\form\\\\delete_comment\",\n                            args: {\n                                commentid: button.closest('[data-comment]').getAttribute('data-comment'),\n                                contextid: contextid,\n                                id: button.closest('[data-task]').getAttribute('data-task')\n                            },\n                            modalConfig: {\n                                title: getString('confirm')\n                            }\n                        });\n                        break;\n                    case 'collapse':\n                        button.closest('[data-modified]').setAttribute('data-modified', 0);\n                        button.closest('[data-type]').querySelector('.block_deft_comments').classList.remove('expanded');\n                        refresh.update();\n                        return;\n                    case 'expand':\n                        button.closest('[data-modified]').setAttribute('data-modified', 0);\n                        button.closest('[data-type]').querySelector('.block_deft_comments').classList.add('expanded');\n                        refresh.update();\n                        return;\n                }\n                modalForm.show();\n            }\n        });\n    }\n};\n"],"names":["init","contextid","selector","refresh","document","querySelector","addEventListener","e","button","target","closest","modalForm","preventDefault","stopPropagation","getAttribute","ModalForm","formClass","args","id","modalConfig","title","commentid","setAttribute","classList","remove","update","add","show"],"mappings":";;;;;;;;gKAYe,CASXA,KAAM,SAASC,UAAWC,SAAUC,SAChCC,SAASC,cAAcH,UAAUI,iBAAiB,SAAUC,UAClDC,OAASD,EAAEE,OAAOC,QAAQ,2CAC5BF,OAAQ,KACJG,iBACJJ,EAAEK,iBACFL,EAAEM,kBACML,OAAOM,aAAa,oBACnB,aACDH,UAAY,IAAII,mBAAU,CACtBC,UAAW,gCACXC,KAAM,CACFhB,UAAWA,UACXiB,GAAIV,OAAOE,QAAQ,eAAeI,aAAa,cAEnDK,YAAa,CACTC,OAAO,mBAAU,2BAIxB,SACDT,UAAY,IAAII,mBAAU,CACtBC,UAAW,mCACXC,KAAM,CACFI,UAAWb,OAAOE,QAAQ,kBAAkBI,aAAa,gBACzDb,UAAWA,UACXiB,GAAIV,OAAOE,QAAQ,eAAeI,aAAa,cAEnDK,YAAa,CACTC,OAAO,mBAAU,wBAIxB,kBACDZ,OAAOE,QAAQ,mBAAmBY,aAAa,gBAAiB,GAChEd,OAAOE,QAAQ,eAAeL,cAAc,wBAAwBkB,UAAUC,OAAO,iBACrFrB,QAAQsB,aAEP,gBACDjB,OAAOE,QAAQ,mBAAmBY,aAAa,gBAAiB,GAChEd,OAAOE,QAAQ,eAAeL,cAAc,wBAAwBkB,UAAUG,IAAI,iBAClFvB,QAAQsB,SAGhBd,UAAUgB"}