define("block_deft/test",["exports","core/ajax","core/fragment","core/log","core/notification","block_deft/socket","core/str","core/toast"],function(_exports,_ajax,_fragment,_log,_notification,_socket,_str,Toast){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}
/*
   * Test the connection with message service
   *
   * @package    block_deft
   * @module     block_deft/test
   * @copyright  2022 Daniel Thies <dethies@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_ajax=_interopRequireDefault(_ajax),_fragment=_interopRequireDefault(_fragment),_log=_interopRequireDefault(_log),_notification=_interopRequireDefault(_notification),_socket=_interopRequireDefault(_socket),Toast=function(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var o,i,f={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return f;if(o=t?n:r){if(o.has(e))return o.get(e);o.set(e,f)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((i=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(i.get||i.set)?o(f,t,i):f[t]=e[t]);return f}(e,t)}(Toast);var _default={init:function(contextid){_log.default.debug("Requesting token"),_ajax.default.call([{methodname:"block_deft_renew_token",args:{contextid:contextid},done:token=>{const socket=new _socket.default(contextid,token.token);(0,_str.get_string)("authorizationreceived","block_deft").done(message=>{Toast.add(message,{type:"info"})}),socket.subscribe(e=>{"message"===e.type&&(0,_str.get_string)("messagereceived","block_deft").done(message=>{Toast.add(message,{type:"success"})})}),setTimeout(()=>{_fragment.default.loadFragment("block_deft","test",contextid,{}).done(message=>{Toast.add(message,{type:"info"})}).fail(_notification.default.exception)},500)},fail:_notification.default.exception}])}};return _exports.default=_default,_exports.default});

//# sourceMappingURL=test.min.js.map