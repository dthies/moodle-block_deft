{"version":3,"file":"choose.min.js","sources":["../src/choose.js"],"sourcesContent":["/*\n * Handle for change for choice seletion\n *\n * @package    block_deft\n * @module     block_deft/choose\n * @copyright  2022 Daniel Thies <dethies@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Fragment from 'core/fragment';\nimport Log from 'core/log';\n\nvar contextid;\n\n/**\n * Handle selection change\n *\n * @param {Event} e Change event\n */\nconst handleChange = async(e) => {\n    let form = e.target.closest('.deft-choice-selector form');\n    if (form) {\n        let formdata = new FormData(form),\n            id = formdata.get('id'),\n            component = form.closest('[data-component]')\n                && form.closest('[data-component]').getAttribute('data-component')\n                || 'block_deft',\n            option = formdata.get('option');\n        e.stopPropagation();\n        e.preventDefault();\n        await Fragment.loadFragment(\n            component,\n            'choose',\n            contextid,\n            {\n                id: id,\n                option: option\n            }\n        ).catch(Log.debug);\n\n        document.body.dispatchEvent(new CustomEvent('deftaction', { }));\n\n        document.activeElement.blur();\n    }\n};\n\n/**\n * Initialize listeners\n *\n * @param {int} id Context id of content bank\n */\nexport const init = (id) => {\n    'use strict';\n\n    contextid = id;\n\n    document.removeEventListener('change', handleChange);\n    document.addEventListener('change', handleChange);\n};\n"],"names":["contextid","handleChange","async","form","e","target","closest","formdata","FormData","id","get","component","getAttribute","option","stopPropagation","preventDefault","Fragment","loadFragment","catch","Log","debug","document","body","dispatchEvent","CustomEvent","activeElement","blur","removeEventListener","addEventListener"],"mappings":";;;;;;;;SAYIA,2KAOEC,aAAeC,MAAAA,QACbC,KAAOC,EAAEC,OAAOC,QAAQ,iCACxBH,KAAM,KACFI,SAAW,IAAIC,SAASL,MACxBM,GAAKF,SAASG,IAAI,MAClBC,UAAYR,KAAKG,QAAQ,qBAClBH,KAAKG,QAAQ,oBAAoBM,aAAa,mBAC9C,aACPC,OAASN,SAASG,IAAI,UAC1BN,EAAEU,kBACFV,EAAEW,uBACIC,kBAASC,aACXN,UACA,SACAX,UACA,CACIS,GAAIA,GACJI,OAAQA,SAEdK,MAAMC,aAAIC,OAEZC,SAASC,KAAKC,cAAc,IAAIC,YAAY,aAAc,KAE1DH,SAASI,cAAcC,uBASVjB,KAGjBT,UAAYS,GAEZY,SAASM,oBAAoB,SAAU1B,cACvCoB,SAASO,iBAAiB,SAAU3B"}