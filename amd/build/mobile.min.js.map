{"version":3,"file":"mobile.min.js","sources":["../src/mobile.js"],"sourcesContent":["/*\n * Open and maintain a WebSocket to recieve messages from server.\n *\n * @package    block_deft\n * @module     block_deft/mobile\n * @copyright  2022 Daniel Thies <dethies@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nif (this.CONTENT_OTHERDATA) {\n    var ws = new WebSocket('wss://deftly.us/ws'),\n        token = this.CONTENT_OTHERDATA.token;\n\n    ws.onopen = function() {\n        ws.send(token);\n    };\n\n    ws.onclose = () => {\n        var id = setInterval(() => {\n            if (navigator.onLine) {\n                clearInterval(id);\n                this.refreshContent(false);\n            }\n        }, 5000);\n    };\n\n    ws.addEventListener('message', () => {\n        setTimeout(function() {\n            if (navigator.onLine) {\n                this.refreshContent(false);\n            }\n        }.bind(this));\n    });\n}\n"],"names":["this","CONTENT_OTHERDATA","ws","WebSocket","token","onopen","send","onclose","id","setInterval","navigator","onLine","clearInterval","refreshContent","addEventListener","setTimeout","bind"],"mappings":";;;;;;;;AASA,GAAIA,OAAKC,kBAAmB,KACpBC,GAAK,IAAIC,UAAU,sBACnBC,MAAQJ,OAAKC,kBAAkBG,MAEnCF,GAAGG,OAAS,WACRH,GAAGI,KAAKF,QAGZF,GAAGK,QAAU,SACLC,GAAKC,aAAY,KACbC,UAAUC,SACVC,cAAcJ,WACTK,gBAAe,MAEzB,MAGPX,GAAGY,iBAAiB,WAAW,KAC3BC,WAAW,WACHL,UAAUC,aACLE,gBAAe,IAE1BG,KAAKhB"}